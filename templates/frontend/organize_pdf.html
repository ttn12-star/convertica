{% extends "frontend/edit_pdf_generic.html" %}
{% load i18n static %}

{% block extra_head %}
  <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js" as="script" crossorigin>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js" defer></script>
  <link rel="stylesheet" href="{% static 'css/pdf-preview.css' %}">
{% endblock %}

{% block edit_options %}
  <div class="bg-gray-50 rounded-xl p-5 sm:p-6 border border-gray-200 mb-6">
    <h3 class="text-lg font-bold mb-4 text-gray-900">{% trans "Organization Settings" %}</h3>

    <div class="space-y-4">
      <div>
        <label for="operation" class="block text-sm font-semibold text-gray-700 mb-2">
          {% trans "Operation" %}
        </label>
        <select id="operation" name="operation"
                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-gray-900">
          <option value="reorder">{% trans "Reorder Pages" %}</option>
          <option value="sort">{% trans "Sort Pages" %}</option>
        </select>
      </div>
    </div>
  </div>

<!-- PDF Preview Section -->
  <div id="pdfPreviewSection" class="hidden bg-gray-50 rounded-xl p-5 sm:p-6 border border-gray-200 mb-6">
    <h3 class="text-lg font-bold mb-4 text-gray-900">{% trans "Reorder Pages" %}</h3>
    <p class="text-sm text-gray-600 mb-4">
      {% trans "Drag and drop pages to reorder them. The number on each page shows the new order." %}
    </p>
    <div id="pdfPreviewContainer" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4">
        <!-- PDF page thumbnails will be added here -->
    </div>
    <!-- Error message container -->
    <div id="errorMessage" class="hidden mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm"></div>
  </div>

  <script>
    window.API_URL = "{{ api_url }}";
    // Organize PDF translations
    window.PAGE_LABEL = "{% trans 'Page' %}";
    window.SELECT_PDF_FILE = "{% trans 'Please select a PDF file.' %}";
    window.SELECT_PDF_FIRST = "{% trans 'Please select a PDF file first.' %}";
    window.FAILED_TO_LOAD_PDF = "{% trans 'Failed to load PDF file. Please try again.' %}";
    window.ORGANIZING = "{% trans 'Organizing...' %}";
    window.FAILED_TO_ORGANIZE = "{% trans 'Failed to organize PDF' %}";
  </script>
  <script src="{% static 'js/organize-pdf.js' %}"></script>
{% endblock %}
