document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("fileInput"),t=document.getElementById("fileInputDrop"),n=document.getElementById("selectFileButton"),r=document.getElementById("addMoreFilesButton"),o=document.getElementById("dropZone"),i=document.getElementById("selectedFile"),d=document.getElementById("fileName"),s=document.getElementById("fileSize"),a=document.getElementById("fileInfo"),l=document.getElementById("removeFile"),c=document.getElementById("convertButton")||document.getElementById("editButton");if(!e)return;let u=null;const f="3.11.174";function m(e){return new Promise((t,n)=>{const r=Array.from(document.scripts).find(t=>t.src===e);if(r)return void 0!==window.pdfjsLib?t():(r.addEventListener("load",()=>t(),{once:!0}),void r.addEventListener("error",()=>n(new Error(`Failed to load ${e}`)),{once:!0}));const o=document.createElement("script");o.src=e,o.async=!0,o.crossOrigin="anonymous",o.onload=()=>t(),o.onerror=()=>n(new Error(`Failed to load ${e}`)),document.head.appendChild(o)})}const g=window.formatFileSize||function(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]};function p(){["converterResult","editorResult","errorMessage"].forEach(e=>{const t=document.getElementById(e);t&&(t.classList.add("hidden"),t.innerHTML="")}),document.querySelectorAll(".bg-red-50.border-red-200").forEach(e=>e.remove())}function b(e){if(!i||!d||!s)return;const t=Array.from(e||[]),n=t[0];if(!n)return;const o=Boolean(window.BATCH_ENABLED&&window.IS_PREMIUM);if(o&&t.length>1){const e=t.reduce((e,t)=>e+(t.size||0),0);d.textContent=`${t.length} files selected`,s.textContent=`Total: ${g(e)}`}else d.textContent=n.name,s.textContent=g(n.size);i.classList.remove("hidden"),a&&a.classList.add("hidden"),r&&(o&&t.length>0&&t.length<10?r.classList.remove("hidden"):r.classList.add("hidden")),1===t.length&&"application/pdf"===n.type?window.validatePdfPageLimit(n).then(e=>{c&&(c.disabled=!e,c.classList.toggle("opacity-50",!e),c.classList.toggle("cursor-not-allowed",!e))}).catch(()=>{c&&(c.disabled=!1,c.classList.remove("opacity-50","cursor-not-allowed"))}):c&&(c.disabled=!1,c.classList.remove("opacity-50","cursor-not-allowed"))}window.validatePdfPageLimit=async function(n){try{if("application/pdf"!==n.type)return!0;if(window.IS_PREMIUM)return!0;if(!await async function(){if(void 0!==window.pdfjsLib)return!0;const e=[`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${f}/pdf.min.js`,`https://unpkg.com/pdfjs-dist@${f}/build/pdf.min.js`];for(const t of e)try{if(await m(t),void 0!==window.pdfjsLib)break}catch(e){}if(void 0===window.pdfjsLib)return!1;try{window.pdfjsLib.GlobalWorkerOptions.workerSrc||(window.pdfjsLib.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${f}/pdf.worker.min.js`)}catch(e){}return!0}())return!0;if(void 0===window.PAGE_LIMIT_ERROR)return console.info("PAGE_LIMIT_ERROR not defined, skipping PDF page validation"),!0;const r=await n.arrayBuffer(),o=(await window.pdfjsLib.getDocument({data:r}).promise).numPages,i=Number(window.MAX_FREE_PDF_PAGES)||30;if(o>i){const n=function(e,t){if(window.IS_PREMIUM)return null;function n(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}if(window.PAGE_LIMIT_ERROR){const r=window.PAGE_LIMIT_ERROR.replace("%(page_count)d",e).replace("%(max_pages)d",t),o="upgrade to Premium";if(window.PREMIUM_LINK&&r.includes(o)){const e=`<a href="${n(window.PREMIUM_LINK)}" class="text-amber-600 hover:text-amber-700 font-medium underline">${n(o)}</a>`;return n(r).replace(n(o),e)}return n(r)}return`PDF has ${n(String(e))} pages (limit: ${n(String(t))}). You can split your file into smaller parts or <a href="/pricing/" class="text-amber-600 hover:text-amber-700 font-medium underline">upgrade to Premium</a> to process larger files with much higher limits!`}(o,i);if(n)return function(n){const r=["converterResult","editorResult","errorMessage"].map(e=>document.getElementById(e)).filter(Boolean)[0],o=`\n            <div class="bg-red-50 border-2 border-red-200 rounded-xl p-6 shadow-lg animate-fade-in">\n                <div class="flex items-start space-x-3">\n                    <svg class="w-6 h-6 text-red-600 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n                    </svg>\n                    <div>\n                        <h4 class="font-semibold text-red-800 mb-1">${window.ERROR_TITLE||"Error"}</h4>\n                        <p class="text-red-700 text-sm">${n}</p>\n                    </div>\n                </div>\n            </div>\n        `;if(r)r.innerHTML=o,r.classList.remove("hidden"),"converterResult"===r.id&&r.scrollIntoView({behavior:"smooth",block:"nearest"});else{const n=document.createElement("div");n.className="bg-red-50 border-2 border-red-200 rounded-xl p-6 shadow-lg animate-fade-in mt-6",n.innerHTML=o;const r=e||t;r&&r.parentNode&&r.parentNode.insertBefore(n,r.nextSibling)}}(n),!1}return p(),!0}catch(e){return console.error("Error validating PDF pages:",e),!0}};function v(e,t=!0){if(!e||0===e.length)return null;if("undefined"!=typeof DataTransfer){const n=new DataTransfer;return(t?Array.from(e):[e[0]]).forEach(e=>n.items.add(e)),n.files}return e}function h(e,t,n=!0){if(!t||0===t.length)return e;if(!n)return v(t,!1);const r=Array.from(e||[]),o=Array.from(t||[]),i=[],d=new Set;[...r,...o].forEach(e=>{if(!e)return;const t=`${e.name}::${e.size}::${e.lastModified}`;d.has(t)||(d.add(t),i.push(e))});const s=i.slice(0,10);return v(s,!0)||s}function w(e,t,n=240){if(!t||!e)return!1;const r=t.getBoundingClientRect(),o=e.clientX,i=e.clientY;return o>=r.left-n&&o<=r.right+n&&i>=r.top-n&&i<=r.bottom+n}if(n&&e&&n.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),setTimeout(()=>{e.click()},0)}),r&&e&&r.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),setTimeout(()=>{e.click()},0)}),e&&e.addEventListener("change",n=>{if(n.target.files&&n.target.files.length>0){const r=e.hasAttribute("multiple"),o=h(u,n.target.files,r);o&&(e.files=o,u=o),t&&function(e,t){if(e.files&&e.files.length>0){const n=v(e.files);n&&(t.files=n)}}(e,t),b(e.files);const i=e.files[0],d=new CustomEvent("fileSelected",{detail:{file:i,files:e.files},bubbles:!0});document.dispatchEvent(d)}}),l&&l.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),i&&i.classList.add("hidden"),a&&a.classList.remove("hidden"),e&&(e.value=""),t&&(t.value=""),r&&r.classList.add("hidden"),u=null,c&&(c.disabled=!0,c.classList.add("opacity-50","cursor-not-allowed"))}),o){let y=0,I=!1;function E(e){e.preventDefault(),e.stopPropagation()}function L(n){y=0,I=!1,o.classList.remove("border-blue-500","bg-blue-100","border-4"),o.classList.add("border-2","border-gray-300","bg-gray-50");const r=n.dataTransfer,i=r?r.files:null;if(i&&i.length>0){const n=t&&t.hasAttribute("multiple"),r=h(u,i,n),o=v(r||i,n);if(e&&o&&(e.files=o),t&&o&&(t.files=o),o&&(u=o),b(o||r||i),e){const t=new Event("change",{bubbles:!0});e.dispatchEvent(t)}if(t){const e=new Event("change",{bubbles:!0});t.dispatchEvent(e)}const d=e&&e.files&&e.files.length>0?e.files[0]:i[0],s=new CustomEvent("fileSelected",{detail:{file:d,files:e&&e.files&&e.files.length>0?e.files:i},bubbles:!0});document.dispatchEvent(s)}}["dragenter","dragover","dragleave","drop"].forEach(e=>{o.addEventListener(e,E,!1)}),o.addEventListener("dragenter",e=>{y++,I=!0,o.classList.add("border-blue-500","bg-blue-100","border-4"),o.classList.remove("border-2","border-gray-300","bg-gray-50")},!1),o.addEventListener("dragover",e=>{I=!0,o.classList.add("border-blue-500","bg-blue-100","border-4"),o.classList.remove("border-2","border-gray-300","bg-gray-50")},!1),o.addEventListener("dragleave",e=>{y--,0===y&&(I=!1,o.classList.remove("border-blue-500","bg-blue-100","border-4"),o.classList.add("border-2","border-gray-300","bg-gray-50"))},!1),o.addEventListener("drop",e=>{e.preventDefault(),e.stopPropagation(),L(e)},!1),["dragover","drop"].forEach(e=>{document.addEventListener(e,t=>{const n=w(t,o,240);if(!n&&"dragover"===e)return I=!1,o.classList.remove("border-blue-500","bg-blue-100","border-4"),void o.classList.add("border-2","border-gray-300","bg-gray-50");n&&(t.preventDefault(),t.stopPropagation(),"dragover"===e?(I=!0,o.classList.add("border-blue-500","bg-blue-100","border-4"),o.classList.remove("border-2","border-gray-300","bg-gray-50")):"drop"===e&&L(t))},!0)}),document.addEventListener("drop",e=>{const t=w(e,o,240);(I||t)&&(e.preventDefault(),e.stopPropagation(),L(e))},!0)}});